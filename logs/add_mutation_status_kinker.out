=============================================================================
ADD MUTATION STATUS - DATASET: kinker
=============================================================================
Expression matrix: output/expression_matrix_kinker.csv
Mutation files: data/ccle_broad_2019/data_mutations.txt data/cellline_ccle_broad/data_mutations.txt
Output file: output/expression_matrix_with_tp53_status_kinker.csv
Cell line column: Cell_line
=============================================================================
Command: python src/add_mutation_status.py --dataset 'kinker' --expression-matrix 'output/expression_matrix_kinker.csv' --output-file 'output/expression_matrix_with_tp53_status_kinker.csv' --cell-line-column 'Cell_line' --mutation-files 'data/ccle_broad_2019/data_mutations.txt' 'data/cellline_ccle_broad/data_mutations.txt'
Starting at: Thu Jul 17 18:58:47 CEST 2025
=============================================================================
Dataset: kinker
Expression matrix file: output/expression_matrix_kinker.csv
Mutation files: ['data/ccle_broad_2019/data_mutations.txt', 'data/cellline_ccle_broad/data_mutations.txt']
Output file: output/expression_matrix_with_tp53_status_kinker.csv
Cell line column: Cell_line
--------------------------------------------------
Processing mutation files to extract TP53 mutation status...
Example keys from master_mutation_dict:
['201T', '42MGBA', '451LU', '5637', '59M', '639V', '8305C', '8505C', '8MGBA', 'A2058']

Processed all mutation files:
  Master TP53 mutation dictionary (unique classification): 913 entries
  Cell lines with multiple TP53 variant types: 102 ['22RV1', '647V', '786O', 'A704', 'AN3CA']...

Loading expression matrix in chunks: output/expression_matrix_kinker.csv
Example cell lines from expression matrix chunk (original):
['NCIH2126_LUNG' 'SW579_THYROID' 'C32_SKIN' 'NCIH446_LUNG'
 'HEC251_ENDOMETRIUM' 'MFE319_ENDOMETRIUM' 'SKNAS_AUTONOMIC_GANGLIA'
 'NCIH2452_PLEURA' 'COLO741_SKIN' 'WM88_SKIN']
Example cell lines from expression matrix chunk (short barcode):
['NCIH2126' 'SW579' 'C32' 'NCIH446' 'HEC251' 'MFE319' 'SKNAS' 'NCIH2452'
 'COLO741' 'WM88']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 5296
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 31767
Total number of cells kept in chunk: 62937
Example cell lines from expression matrix chunk (original):
['HOS_BONE' 'SNU449_LIVER' 'ABC1_LUNG' 'LS180_LARGE_INTESTINE'
 'RERFLCAI_LUNG' 'RT4_URINARY_TRACT' 'EBC1_LUNG' 'TE9_OESOPHAGUS'
 'HUCCT1_BILIARY_TRACT' 'MKN45_STOMACH']
Example cell lines from expression matrix chunk (short barcode):
['HOS' 'SNU449' 'ABC1' 'LS180' 'RERFLCAI' 'RT4' 'EBC1' 'TE9' 'HUCCT1'
 'MKN45']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 4473
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 32219
Total number of cells kept in chunk: 63308
Example cell lines from expression matrix chunk (original):
['OVTOKO_OVARY' 'OVSAHO_OVARY' 'SNUC4_LARGE_INTESTINE' 'TE1_OESOPHAGUS'
 'LMSU_STOMACH' 'GOS3_CENTRAL_NERVOUS_SYSTEM' 'SKMEL30_SKIN' 'RVH421_SKIN'
 'VMRCRCZ_KIDNEY' 'JHOS2_OVARY']
Example cell lines from expression matrix chunk (short barcode):
['OVTOKO' 'OVSAHO' 'SNUC4' 'TE1' 'LMSU' 'GOS3' 'SKMEL30' 'RVH421'
 'VMRCRCZ' 'JHOS2']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 4959
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 31729
Total number of cells kept in chunk: 63312
Example cell lines from expression matrix chunk (original):
['nan' 'NCIH1299_LUNG' 'BFTC909_KIDNEY' 'HT1080_SOFT_TISSUE'
 'DAOY_CENTRAL_NERVOUS_SYSTEM' 'IGR37_SKIN' 'NCIH460_LUNG'
 '42MGBA_CENTRAL_NERVOUS_SYSTEM' 'IGR1_SKIN'
 'YD38_UPPER_AERODIGESTIVE_TRACT']
Example cell lines from expression matrix chunk (short barcode):
['nan' 'NCIH1299' 'BFTC909' 'HT1080' 'DAOY' 'IGR37' 'NCIH460' '42MGBA'
 'IGR1' 'YD38']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 5493
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 30493
Total number of cells kept in chunk: 64014
Example cell lines from expression matrix chunk (original):
['C32_SKIN' 'SNU899_UPPER_AERODIGESTIVE_TRACT' 'WM88_SKIN'
 'KPNSI9S_AUTONOMIC_GANGLIA' 'HEC108_ENDOMETRIUM' 'HT1376_URINARY_TRACT'
 'NCIH2126_LUNG' 'SW1271_LUNG' 'NCIH2452_PLEURA' 'JHH7_LIVER']
Example cell lines from expression matrix chunk (short barcode):
['C32' 'SNU899' 'WM88' 'KPNSI9S' 'HEC108' 'HT1376' 'NCIH2126' 'SW1271'
 'NCIH2452' 'JHH7']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 5270
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 31540
Total number of cells kept in chunk: 63190
Example cell lines from expression matrix chunk (original):
['SKES1_BONE' 'RERFLCAI_LUNG' 'LS180_LARGE_INTESTINE' 'NCIH1373_LUNG'
 'HUCCT1_BILIARY_TRACT' 'TE9_OESOPHAGUS' 'CAMA1_BREAST' 'EBC1_LUNG'
 'NCIH1435_LUNG' 'HEC151_ENDOMETRIUM']
Example cell lines from expression matrix chunk (short barcode):
['SKES1' 'RERFLCAI' 'LS180' 'NCIH1373' 'HUCCT1' 'TE9' 'CAMA1' 'EBC1'
 'NCIH1435' 'HEC151']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 4593
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 32253
Total number of cells kept in chunk: 63154
Example cell lines from expression matrix chunk (original):
['SNUC4_LARGE_INTESTINE' 'JHOS2_OVARY' 'MFE280_ENDOMETRIUM'
 'PK59_PANCREAS' 'TOV21G_OVARY' 'SNU738_CENTRAL_NERVOUS_SYSTEM'
 'VMRCRCZ_KIDNEY' 'T47D_BREAST' 'GOS3_CENTRAL_NERVOUS_SYSTEM' 'CALU6_LUNG']
Example cell lines from expression matrix chunk (short barcode):
['SNUC4' 'JHOS2' 'MFE280' 'PK59' 'TOV21G' 'SNU738' 'VMRCRCZ' 'T47D' 'GOS3'
 'CALU6']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 4875
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 32011
Total number of cells kept in chunk: 63114
Example cell lines from expression matrix chunk (original):
['YD38_UPPER_AERODIGESTIVE_TRACT' 'NCIH460_LUNG' 'LI7_LIVER'
 'HT1080_SOFT_TISSUE' 'DAOY_CENTRAL_NERVOUS_SYSTEM' 'SJSA1_BONE'
 'BFTC909_KIDNEY' 'nan' 'VMCUB1_URINARY_TRACT' 'SBC5_LUNG']
Example cell lines from expression matrix chunk (short barcode):
['YD38' 'NCIH460' 'LI7' 'HT1080' 'DAOY' 'SJSA1' 'BFTC909' 'nan' 'VMCUB1'
 'SBC5']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 5478
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 30402
Total number of cells kept in chunk: 64120
Example cell lines from expression matrix chunk (original):
['NCIH446_LUNG' 'TM31_CENTRAL_NERVOUS_SYSTEM' 'MFE319_ENDOMETRIUM'
 'C32_SKIN' 'NCIH2452_PLEURA' 'HT1376_URINARY_TRACT' 'WM88_SKIN'
 'HEC251_ENDOMETRIUM' 'NCIH2126_LUNG' 'KPNSI9S_AUTONOMIC_GANGLIA']
Example cell lines from expression matrix chunk (short barcode):
['NCIH446' 'TM31' 'MFE319' 'C32' 'NCIH2452' 'HT1376' 'WM88' 'HEC251'
 'NCIH2126' 'KPNSI9S']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 5249
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 31305
Total number of cells kept in chunk: 63446
Example cell lines from expression matrix chunk (original):
['SNU1196_BILIARY_TRACT' 'RERFLCAI_LUNG' 'HOS_BONE'
 'LS180_LARGE_INTESTINE' 'EBC1_LUNG' 'A204_SOFT_TISSUE'
 'HT55_LARGE_INTESTINE' 'NCIH292_LUNG' 'MDAMB436_BREAST' 'ABC1_LUNG']
Example cell lines from expression matrix chunk (short barcode):
['SNU1196' 'RERFLCAI' 'HOS' 'LS180' 'EBC1' 'A204' 'HT55' 'NCIH292'
 'MDAMB436' 'ABC1']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 4710
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 32317
Total number of cells kept in chunk: 62973
Example cell lines from expression matrix chunk (original):
['PC3_PROSTATE' 'PATU8988S_PANCREAS' 'HUH6_LIVER' 'NCIH522_LUNG'
 'HS852T_SKIN' 'SNUC4_LARGE_INTESTINE' 'MSTO211H_PLEURA' 'CALU6_LUNG'
 'LMSU_STOMACH' 'SKMEL30_SKIN']
Example cell lines from expression matrix chunk (short barcode):
['PC3' 'PATU8988S' 'HUH6' 'NCIH522' 'HS852T' 'SNUC4' 'MSTO211H' 'CALU6'
 'LMSU' 'SKMEL30']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 4799
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 32241
Total number of cells kept in chunk: 62960
Example cell lines from expression matrix chunk (original):
['NCIH460_LUNG' 'LI7_LIVER' 'YD38_UPPER_AERODIGESTIVE_TRACT' 'IGR1_SKIN'
 'FTC133_THYROID' 'HMC18_BREAST' 'nan' 'VMCUB1_URINARY_TRACT' 'JHH6_LIVER'
 'IGR37_SKIN']
Example cell lines from expression matrix chunk (short barcode):
['NCIH460' 'LI7' 'YD38' 'IGR1' 'FTC133' 'HMC18' 'nan' 'VMCUB1' 'JHH6'
 'IGR37']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 5468
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 30341
Total number of cells kept in chunk: 64191
Example cell lines from expression matrix chunk (original):
['WM88_SKIN' 'TYKNU_OVARY' 'C32_SKIN' 'NCIH446_LUNG' 'NCIH2452_PLEURA'
 'JHH7_LIVER' 'NCIH2126_LUNG' 'MFE319_ENDOMETRIUM' 'HCC38_BREAST'
 'SW579_THYROID']
Example cell lines from expression matrix chunk (short barcode):
['WM88' 'TYKNU' 'C32' 'NCIH446' 'NCIH2452' 'JHH7' 'NCIH2126' 'MFE319'
 'HCC38' 'SW579']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 5218
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 31083
Total number of cells kept in chunk: 63699
Example cell lines from expression matrix chunk (original):
['ABC1_LUNG' 'RERFLCAI_LUNG' 'RT4_URINARY_TRACT' 'HUCCT1_BILIARY_TRACT'
 'MDAMB436_BREAST' 'HEP3B217_LIVER' 'EBC1_LUNG' 'HOS_BONE'
 'LS180_LARGE_INTESTINE' 'HT55_LARGE_INTESTINE']
Example cell lines from expression matrix chunk (short barcode):
['ABC1' 'RERFLCAI' 'RT4' 'HUCCT1' 'MDAMB436' 'HEP3B217' 'EBC1' 'HOS'
 'LS180' 'HT55']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 4828
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 32401
Total number of cells kept in chunk: 62771
Example cell lines from expression matrix chunk (original):
['NCIH358_LUNG' 'KPL1_BREAST' 'nan' 'COLO792_SKIN' 'PANC0203_PANCREAS'
 'CL34_LARGE_INTESTINE' 'NCIH727_LUNG' 'SNU423_LIVER' 'TE6_OESOPHAGUS'
 'NCIH2077_LUNG']
Example cell lines from expression matrix chunk (short barcode):
['NCIH358' 'KPL1' 'nan' 'COLO792' 'PANC0203' 'CL34' 'NCIH727' 'SNU423'
 'TE6' 'NCIH2077']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 4709
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 32459
Total number of cells kept in chunk: 62832
Example cell lines from expression matrix chunk (original):
['A375_SKIN' 'NCIH460_LUNG' 'SJSA1_BONE' 'YD38_UPPER_AERODIGESTIVE_TRACT'
 'NCIH1299_LUNG' 'nan' 'VMCUB1_URINARY_TRACT' 'JHH6_LIVER'
 'BFTC909_KIDNEY' 'LI7_LIVER']
Example cell lines from expression matrix chunk (short barcode):
['A375' 'NCIH460' 'SJSA1' 'YD38' 'NCIH1299' 'nan' 'VMCUB1' 'JHH6'
 'BFTC909' 'LI7']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 5463
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 30267
Total number of cells kept in chunk: 64270
Example cell lines from expression matrix chunk (original):
['KPNSI9S_AUTONOMIC_GANGLIA' 'SKNAS_AUTONOMIC_GANGLIA' 'nan'
 'COLO741_SKIN' 'NCIH2452_PLEURA' 'JHH7_LIVER' 'HEC108_ENDOMETRIUM'
 'HEC251_ENDOMETRIUM' 'HT1376_URINARY_TRACT' 'MFE319_ENDOMETRIUM']
Example cell lines from expression matrix chunk (short barcode):
['KPNSI9S' 'SKNAS' 'nan' 'COLO741' 'NCIH2452' 'JHH7' 'HEC108' 'HEC251'
 'HT1376' 'MFE319']

Processing new chunk...
Initial number of cells in chunk: 100000
Number of cells removed (due to multiple TP53 mutations for the cell line): 5279
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 30836
Total number of cells kept in chunk: 63885
Example cell lines from expression matrix chunk (original):
['CAKI2_KIDNEY' 'TE14_OESOPHAGUS' 'NCIH2228_LUNG' 'ONCODG1_OVARY'
 'SKMEL5_SKIN' 'NCIH2073_LUNG' 'OVCAR4_OVARY' 'NCIH2444_LUNG'
 'U118MG_CENTRAL_NERVOUS_SYSTEM' '8305C_THYROID']
Example cell lines from expression matrix chunk (short barcode):
['CAKI2' 'TE14' 'NCIH2228' 'ONCODG1' 'SKMEL5' 'NCIH2073' 'OVCAR4'
 'NCIH2444' 'U118MG' '8305C']

Processing new chunk...
Initial number of cells in chunk: 66442
Number of cells removed (due to multiple TP53 mutations for the cell line): 3275
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 21158
Total number of cells kept in chunk: 42009
Processing complete.
=============================================================================
Done at: Thu Jul 17 19:02:11 CEST 2025
=============================================================================
