=============================================================================
ADD MUTATION STATUS - DATASET: gambardella
=============================================================================
Expression matrix: output/expression_matrix_gambardella.csv
Mutation files: data/ccle_broad_2019/data_mutations.txt data/cellline_ccle_broad/data_mutations.txt
Output file: output/expression_matrix_with_tp53_status_gambardella.csv
Cell line column: Cell_line
=============================================================================
Command: python src/add_mutation_status.py --dataset 'gambardella' --expression-matrix 'output/expression_matrix_gambardella.csv' --output-file 'output/expression_matrix_with_tp53_status_gambardella.csv' --cell-line-column 'Cell_line' --chunk-size 10000 --mutation-files 'data/ccle_broad_2019/data_mutations.txt' 'data/cellline_ccle_broad/data_mutations.txt'
Starting at: Thu Jul 17 19:48:19 CEST 2025
=============================================================================
Dataset: gambardella
Expression matrix file: output/expression_matrix_gambardella.csv
Mutation files: ['data/ccle_broad_2019/data_mutations.txt', 'data/cellline_ccle_broad/data_mutations.txt']
Output file: output/expression_matrix_with_tp53_status_gambardella.csv
Cell line column: Cell_line
Chunk size: 10000
--------------------------------------------------
Processing mutation files to extract TP53 mutation status...
Example keys from master_mutation_dict:
['201T', '42MGBA', '451LU', '5637', '59M', '639V', '8305C', '8505C', '8MGBA', 'A2058']

Processed all mutation files:
  Master TP53 mutation dictionary (unique classification): 913 entries
  Cell lines with multiple TP53 variant types: 102 ['22RV1', '647V', '786O', 'A704', 'AN3CA']...

Loading expression matrix in chunks: output/expression_matrix_gambardella.csv
Chunk size: 10000
Example cell lines from expression matrix chunk (original):
['AU565' 'HCC1937' 'HCC38' 'MDAMB468' 'EFM19' 'HCC1187' 'JIMT1' 'MDAMB361'
 'HCC1500' 'HCC70']
Example cell lines from expression matrix chunk (short barcode):
['AU565' 'HCC1937' 'HCC38' 'MDAMB468' 'EFM19' 'HCC1187' 'JIMT1' 'MDAMB361'
 'HCC1500' 'HCC70']

Processing new chunk...
Initial number of cells in chunk: 10000
Number of cells removed (due to multiple TP53 mutations for the cell line): 0
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 615
Total number of cells kept in chunk: 9385
Example cell lines from expression matrix chunk (original):
['HCC70' 'CAL51' 'MDAMB415' 'BT549' 'BT483' 'MDAMB436' 'DU4475' 'HS578T'
 'MCF7' 'CAMA1']
Example cell lines from expression matrix chunk (short barcode):
['HCC70' 'CAL51' 'MDAMB415' 'BT549' 'BT483' 'MDAMB436' 'DU4475' 'HS578T'
 'MCF7' 'CAMA1']

Processing new chunk...
Initial number of cells in chunk: 10000
Number of cells removed (due to multiple TP53 mutations for the cell line): 0
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 2106
Total number of cells kept in chunk: 7894
Example cell lines from expression matrix chunk (original):
['BT20' 'T47D' 'MDAMB436' 'EVSAT' 'MCF7' 'HDQP1' 'BT474' 'CAL851'
 'HCC1143' 'MCF12A']
Example cell lines from expression matrix chunk (short barcode):
['BT20' 'T47D' 'MDAMB436' 'EVSAT' 'MCF7' 'HDQP1' 'BT474' 'CAL851'
 'HCC1143' 'MCF12A']

Processing new chunk...
Initial number of cells in chunk: 10000
Number of cells removed (due to multiple TP53 mutations for the cell line): 0
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 2152
Total number of cells kept in chunk: 7848
Example cell lines from expression matrix chunk (original):
['HCC1954' 'KPL1' 'ZR751' 'MX1' 'MDAMB453']
Example cell lines from expression matrix chunk (short barcode):
['HCC1954' 'KPL1' 'ZR751' 'MX1' 'MDAMB453']

Processing new chunk...
Initial number of cells in chunk: 5276
Number of cells removed (due to multiple TP53 mutations for the cell line): 0
Number of cells removed (cell line not in mutation data or no single TP53 entry after filtering multi-mut): 3824
Total number of cells kept in chunk: 1452
Processing complete.
=============================================================================
Done at: Thu Jul 17 20:04:50 CEST 2025
=============================================================================
